---
title: "Bomrang Temp app"
author: "Kevin Wang"
date: "07/03/2020"
output: html_document
runtime: shiny
---

```{r}
suppressPackageStartupMessages({
  library(bomrang)
  library(tidyverse)
  library(shiny)
})
```


```{r}
location = "Sydney airport"

weather = bomrang::get_current_weather(location)

glimpse(weather)

weather %>% 
  ggplot(aes(x = local_date_time_full,
             y = wind_spd_kmh)) +
  geom_path() +
  labs(x = "Time", 
       y = "Wind (km/h)",
       title = "SYD airport wind speed")
```


```{r}
shiny::textInput(inputId = "location",
                   label = "Put a location here!",
                   value = "Sydney airport")

renderPlot({
  weather = get_current_weather(input$location)
  
  subtitle = ifelse(any(weather$wind_spd_kmh >= 30), "Wind warning", "All normal")
  
  weather %>% 
    ggplot(aes(x = local_date_time_full,
               y = wind_spd_kmh)) +
    geom_path() +
    labs(x = "Time", 
         y = "Wind (km/h)",
         title = weather$full_name[1],
         subtitle = subtitle)
})
```